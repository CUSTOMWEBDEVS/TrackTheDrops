:root{--bg:#0b0e13;--panel:#101622;--ink:#e7eef8;--muted:#9fb2c7;--line:#263245;--accent:#ef4444}
*{box-sizing:border-box}html,body{height:100%;margin:0;background:var(--bg);color:var(--ink);font-family:Inter,system-ui,Segoe UI,Roboto,sans-serif}
.topbar{display:flex;align-items:center;justify-content:space-between;padding:10px 14px;border-bottom:1px solid var(--line);background:linear-gradient(180deg,#0e141f 0%,rgba(14,20,31,0) 100%)}
.brand{display:flex;gap:8px;align-items:center;font-weight:600;letter-spacing:.2px}.brand .dot{width:10px;height:10px;border-radius:50%;background:var(--accent);box-shadow:0 0 12px rgba(239,68,68,.6)}
.actions{display:flex;gap:8px;align-items:center}
.toggle{display:flex;gap:6px;align-items:center;color:var(--muted)}
.ghost{background:transparent;color:var(--muted);border:1px solid var(--line);padding:6px 10px;border-radius:10px}
.layout{display:grid;grid-template-columns:1fr 320px;gap:12px;max-width:1400px;margin:10px auto;padding:0 10px}
.onlyViewport{grid-template-columns:1fr 320px}
.viewport{position:relative;background:#000;border:1px solid var(--line);border-radius:14px;overflow:hidden;min-height:340px}
video{position:absolute;inset:0;width:100%;height:100%;object-fit:contain}
video.gray{filter:grayscale(100%)}
.overlay{position:absolute;inset:0;width:100%;height:100%;object-fit:contain;mix-blend-mode:screen;pointer-events:none}
.tap-hint{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-weight:600;color:#fff;background:rgba(0,0,0,.35);backdrop-filter:blur(2px);z-index:6}
.hud{position:absolute;right:12px;top:12px;display:flex;gap:10px;font-size:12px;color:#d7deef;background:rgba(12,17,25,.6);padding:6px 8px;border-radius:10px;border:1px solid var(--line);z-index:5}
.panel{display:flex;flex-direction:column;gap:12px}
.card{background:var(--panel);border:1px solid var(--line);border-radius:14px;padding:12px}
.card.small{font-size:13px;color:var(--muted)}
.row{display:grid;grid-template-columns:120px 1fr;align-items:center;gap:10px;margin:8px 0}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:6px}
button,select,input[type=range]{background:#0e1522;color:var(--ink);border:1px solid var(--line);border-radius:10px;padding:10px}
button:disabled{opacity:.55;cursor:not-allowed}
.hint{color:#ffd166;margin-top:6px;font-size:12px;white-space:pre-wrap}
.foot{text-align:center;color:var(--muted);padding:10px 0 20px}

/* Map dock */
.mapDock{position:fixed;left:10px;right:10px;bottom:10px;height:42vh;border:1px solid var(--line);border-radius:14px;overflow:hidden;background:var(--panel);display:flex;flex-direction:column}
.mapHeader{display:flex;justify-content:space-between;align-items:center;padding:8px 10px;border-bottom:1px solid var(--line)}
.mapActions{display:flex;gap:8px;align-items:center}
.map{flex:1;min-height:200px}
.leaflet-control-attribution{background:rgba(0,0,0,.45)!important;color:#cbd5e1!important}
.leaflet-container{background:#0a0f16}
/* Fullscreen on small screens */
@media (max-width: 900px){
  .layout{grid-template-columns:1fr}
  .panel{order:3}
  .mapDock{left:6px;right:6px;height:45vh}
}
